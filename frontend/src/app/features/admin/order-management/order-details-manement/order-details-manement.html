<div class="flex flex-col py-3 px-6 w-full">
   @if (isLoading()) {
    <app-loading-spinner></app-loading-spinner>
  }

  @if (error) {
    <div class="alert alert-danger">
      {{ error }}
    </div>
  }

  @if (!isLoading() && order(); as orderDetails) {
    <mat-card class="shadow-lg">
      <mat-card-header>
        <mat-card-title class="text-xl font-bold">Order #{{ orderDetails.orderNumber }}</mat-card-title>
        <mat-card-subtitle>
          <p>Date: {{ orderDetails.orderDate | date:'medium' }}</p>
          <p>Status: <span class="px-3 py-1 rounded-full text-sm font-medium {{ getStatusBadgeClass(orderDetails.status) }}">{{ orderDetails.status }}</span></p>
        </mat-card-subtitle>
      </mat-card-header>
      <mat-card-content>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
          <!-- Order Summary -->
          <div>
            <h3 class="text-lg font-semibold mb-2">Order Summary</h3>
            <div class="space-y-1">
              <p>Total Amount: {{ orderDetails.totalAmount |currency:"R"}}</p>
            </div>
          </div>

          <!-- Order Items -->
          <div>
            <h3 class="text-lg font-semibold mb-2">Items</h3>
            <mat-list>
              @for (item of orderDetails.items; track item.productId) {
                <mat-list-item class="border-b border-gray-200 py-2">
                  <div class="flex items-center">
                    @if (item.productImageUrl) {
                      <img [src]="item.productImageUrl" [alt]="item.productName" class="w-16 h-16 object-cover mr-4 rounded">
                    }
                    <div class="flex-1">
                      <h4 class="font-medium">{{ item.productName }}</h4>
                      <p class="text-sm text-gray-600">Quantity: {{ item.quantity }}</p>
                      <p class="text-sm text-gray-600">Unit Price: {{ item.unitPrice|currency:"R" }}</p>
                      <p class="text-sm font-semibold">Total: {{ getItemTotal(item) |currency:"R"}}</p>
                    </div>
                  </div>
                </mat-list-item>
              }
            </mat-list>
          </div>
        </div>

        @if (orderDetails.paymentId) {
          <div class="mt-6">
            <h3 class="text-lg font-semibold mb-2">Payment Information</h3>
            <p>Payment ID: {{ orderDetails.paymentId }}</p>
          </div>
        }
      </mat-card-content>
    </mat-card>
  }
</div>
